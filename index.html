<!DOCTYPE html>
<html>
<head>
  <title>财务指标计算器</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    
    th, td {
      text-align: left;
      padding: 8px;
    }
    
    th {
      background-color: #f2f2f2;
    }
    
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    #calculator-form {
      margin-top: 20px;
    }
    
    #calculator-form label {
      display: block;
      margin-bottom: 5px;
    }
    
    #calculator-form input[type="text"] {
      width: 100px;
    }
    
    #calculate-button {
      margin-top: 10px;
    }
    
    #result-table {
      margin-top: 20px;
      width: 100%;
    }
    
    #result-table td {
      font-weight: bold;
    }
    
    .good-value {
      color: green;
    }
    
    .bad-value {
      color: red;
    }
  </style>
</head>
<body>
  <h1>财务指标计算器</h1>
  
  <table>
    <tr>
      <th>指标名称</th>
      <th>指标计算公式</th>
      <th>指标理想范围</th>
      <th>指标含义描述</th>
    </tr>
    <tr>
      <td>流动比率</td>
      <td>流动资产 / 流动负债</td>
      <td>&gt;= 1</td>
      <td>衡量公司偿还短期债务能力的指标，数值大于1表示偿债能力较好。</td>
    </tr>
    <tr>
      <td>速动比率</td>
      <td>(流动资产 - 存货) / 流动负债</td>
      <td>&gt;= 1</td>
      <td>除去存货后的流动资产与流动负债比率，反映了公司在不考虑存货的情况下偿债能力。</td>
    </tr>
    <tr>
      <td>资产负债率</td>
      <td>负债合计 / 总资产</td>
      <td>&lt;= 0.5</td>
      <td>衡量公司债务占总资产的比例，数值小于等于0.5表示负债较低。</td>
    </tr>
    <tr>
      <td>应收账款周转率</td>
      <td>营业收入 / 应收账款</td>
      <td>高于行业平均</td>
      <td>衡量公司应收账款的收回速度，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>存货周转率</td>
      <td>营业成本 / 存货</td>
      <td>高于行业平均</td>
      <td>衡量公司存货的周转速度，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>应付账款周转率</td>
      <td>营业成本 / 应付账款</td>
      <td>高于行业平均</td>
      <td>衡量公司应付账款的支付速度，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>营业周期</td>
      <td>存货周转天数 + 应收账款周转天数</td>
      <td>&lt;= 180</td>
      <td>表示公司从采购原材料到收回销售款项的周期，数值小于等于180天表示较好。</td>
    </tr>
    <tr>
      <td>现金周期</td>
      <td>存货周转天数 + 应收账款周转天数 - 应付账款周转天数</td>
      <td>&lt;= 90</td>
      <td>表示公司从采购原材料到收回现金的周期，数值小于等于90天表示较好。</td>
    </tr>
    <tr>
      <td>毛利率</td>
      <td>(营业收入 - 营业成本) / 营业收入</td>
      <td>高于行业平均</td>
      <td>衡量公司每单位销售收入中的毛利润比例，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>销售净利率</td>
      <td>净利润 / 营业收入</td>
      <td>高于行业平均</td>
      <td>衡量公司每单位销售收入中的净利润比例，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>总资产周转率</td>
      <td>营业收入 / 总资产</td>
      <td>高于行业平均</td>
      <td>衡量公司利用资产创造销售收入的能力，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>投资回报率 (ROA)</td>
      <td>(净利润 / 总资产) * 100</td>
      <td>高于行业平均</td>
      <td>衡量公司利用资产创造利润的能力，数值高于行业平均表示较好。</td>
    </tr>
    <tr>
      <td>权益乘数</td>
      <td>总资产 / 权益总额</td>
      <td>适当范围内</td>
      <td>衡量公司债务资金占股东权益的比例，数值应在适当范围内，避免过度负债。</td>
    </tr>
    <tr>
      <td>权益报酬率 (ROE)</td>
      <td>(净利润 / 股东权益平均余额) * 100</td>
      <td>高于行业平均</td>
      <td>衡量公司股东投资的收益率，数值高于行业平均表示较好。</td>
    </tr>
  </table>
  
  <div id="calculator-form">
    <h2>输入财报数据</h2>
    <form id="input-form">
      <label for="current-assets-input">流动资产：</label>
      <input type="text" id="current-assets-input" />
      
      <label for="current-liabilities-input">流动负债：</label>
      <input type="text" id="current-liabilities-input" />
      
      <label for="inventory-input">存货：</label>
      <input type="text" id="inventory-input" />
      
      <label for="total-assets-input">总资产：</label>
      <input type="text" id="total-assets-input" />
      
      <label for="total-liabilities-input">负债合计：</label>
      <input type="text" id="total-liabilities-input" />
      
      <label for="operating-income-input">营业收入：</label>
      <input type="text" id="operating-income-input" />
      
      <label for="receivables-input">应收账款：</label>
      <input type="text" id="receivables-input" />
      
      <label for="cost-of-goods-sold-input">营业成本：</label>
      <input type="text" id="cost-of-goods-sold-input" />
      
      <label for="payables-input">应付账款：</label>
      <input type="text" id="payables-input" />
      
      <div>
        <button id="calculate-button" type="button">计算</button>
      </div>
    </form>
  </div>
  
  <div id="result-table">
    <h2>计算结果</h2>
    <table>
      <tr>
        <th>指标名称</th>
        <th>计算结果</th>
        <th>理想范围</th>
        <th>分析与建议</th>
      </tr>
      <tbody id="result-body"></tbody>
    </table>
  </div>
  
  <script>
    document.getElementById('calculate-button').addEventListener('click', calculateIndicators);
    
    function calculateIndicators() {
      var inputData = {
        currentAssets: parseFloat(document.getElementById('current-assets-input').value),
        currentLiabilities: parseFloat(document.getElementById('current-liabilities-input').value),
        inventory: parseFloat(document.getElementById('inventory-input').value),
        totalAssets: parseFloat(document.getElementById('total-assets-input').value),
        totalLiabilities: parseFloat(document.getElementById('total-liabilities-input').value),
        operatingIncome: parseFloat(document.getElementById('operating-income-input').value),
        receivables: parseFloat(document.getElementById('receivables-input').value),
        costOfGoodsSold: parseFloat(document.getElementById('cost-of-goods-sold-input').value),
        payables: parseFloat(document.getElementById('payables-input').value)
      };
      
      var results = {
        '流动比率': calculateCurrentRatio(inputData.currentAssets, inputData.currentLiabilities),
        '速动比率': calculateQuickRatio(inputData.currentAssets, inputData.inventory, inputData.currentLiabilities),
        '资产负债率': calculateDebtRatio(inputData.totalLiabilities, inputData.totalAssets),
        '应收账款周转率': calculateReceivablesTurnover(inputData.operatingIncome, inputData.receivables),
        '存货周转率': calculateInventoryTurnover(inputData.costOfGoodsSold, inputData.inventory),
        '应付账款周转率': calculatePayablesTurnover(inputData.costOfGoodsSold, inputData.payables),
        '营业周期': calculateOperatingCycle(inputData.inventory, inputData.receivables),
        '现金周期': calculateCashCycle(inputData.inventory, inputData.receivables, inputData.payables),
        '毛利率': calculateGrossProfitMargin(inputData.operatingIncome, inputData.costOfGoodsSold),
        '销售净利率': calculateNetProfitMargin(inputData.operatingIncome, inputData.costOfGoodsSold),
        '总资产周转率': calculateTotalAssetTurnover(inputData.operatingIncome, inputData.totalAssets),
        '投资回报率 (ROA)': calculateROA(inputData.costOfGoodsSold, inputData.totalAssets),
        '权益乘数': calculateEquityMultiplier(inputData.totalAssets, inputData.totalLiabilities),
        '权益报酬率 (ROE)': calculateROE(inputData.costOfGoodsSold, inputData.totalLiabilities)
      };
      
      var resultBody = document.getElementById('result-body');
      resultBody.innerHTML = '';
      
      for (var indicator in results) {
        var value = results[indicator];
        var idealRange = getIdealRange(indicator);
        
        var row = document.createElement('tr');
        
        var indicatorCell = document.createElement('td');
        indicatorCell.textContent = indicator;
        row.appendChild(indicatorCell);
        
        var valueCell = document.createElement('td');
        valueCell.textContent = value.toFixed(2);
        row.appendChild(valueCell);
        
        var idealRangeCell = document.createElement('td');
        idealRangeCell.textContent = idealRange;
        row.appendChild(idealRangeCell);
        
        var analysisCell = document.createElement('td');
        analysisCell.textContent = analyzeIndicator(indicator, value, idealRange);
        row.appendChild(analysisCell);
        
        resultBody.appendChild(row);
      }
    }
    
    function getIdealRange(indicator) {
      switch (indicator) {
        case '流动比率':
        case '速动比率':
          return '>= 1';
        case '资产负债率':
          return '<= 0.5';
        case '应收账款周转率':
        case '存货周转率':
        case '应付账款周转率':
        case '总资产周转率':
        case '投资回报率 (ROA)':
          return '高于行业平均';
        case '营业周期':
        case '现金周期':
          return '<= 90';
        case '毛利率':
        case '销售净利率':
          return '高于行业平均';
        case '权益乘数':
          return '适当范围内';
        case '权益报酬率 (ROE)':
          return '高于行业平均';
        default:
          return '';
      }
    }
    
    function analyzeIndicator(indicator, value, idealRange) {
      if (value > idealRange) {
        return '数值较好，表示' + getIndicatorDescription(indicator) + '。建议控制风险并寻找增长机会。';
      } else if (value < idealRange) {
        return '数值较低，表示' + getIndicatorDescription(indicator) + '。建议优化经营策略和资源利用，提高效率。';
      } else {
        return '数值符合理想范围';
      }
    }
    
    function getIndicatorDescription(indicator) {
      switch (indicator) {
        case '流动比率':
          return '公司具备较好的偿债能力';
        case '速动比率':
          return '公司在不考虑存货的情况下具备较好的偿债能力';
        case '资产负债率':
          return '公司负债较低';
        case '应收账款周转率':
          return '公司应收账款收回速度较快';
        case '存货周转率':
          return '公司存货周转速度较快';
        case '应付账款周转率':
          return '公司应付账款支付速度较快';
        case '营业周期':
          return '公司从采购原材料到收回销售款项的周期较短';
        case '现金周期':
          return '公司从采购原材料到收回现金的周期较短';
        case '毛利率':
          return '公司每单位销售收入中的毛利润比例较高';
        case '销售净利率':
          return '公司每单位销售收入中的净利润比例较高';
        case '总资产周转率':
          return '公司利用资产创造销售收入的能力较好';
        case '投资回报率 (ROA)':
          return '公司利用资产创造利润的能力较好';
        case '权益乘数':
          return '公司债务资金占股东权益的比例适当';
        case '权益报酬率 (ROE)':
          return '公司股东投资的收益率较高';
        default:
          return '';
      }
    }
    
    function calculateCurrentRatio(currentAssets, currentLiabilities) {
      return currentAssets / currentLiabilities;
    }
    
    function calculateQuickRatio(currentAssets, inventory, currentLiabilities) {
      return (currentAssets - inventory) / currentLiabilities;
    }
    
    function calculateDebtRatio(totalLiabilities, totalAssets) {
      return totalLiabilities / totalAssets;
    }
    
    function calculateReceivablesTurnover(operatingIncome, receivables) {
      return operatingIncome / receivables;
    }
    
    function calculateInventoryTurnover(costOfGoodsSold, inventory) {
      return costOfGoodsSold / inventory;
    }
    
    function calculatePayablesTurnover(costOfGoodsSold, payables) {
      return costOfGoodsSold / payables;
    }
    
    function calculateOperatingCycle(inventory, receivables) {
      return inventory + receivables;
    }
    
    function calculateCashCycle(inventory, receivables, payables) {
      return inventory + receivables - payables;
    }
    
    function calculateGrossProfitMargin(operatingIncome, costOfGoodsSold) {
      return ((operatingIncome - costOfGoodsSold) / operatingIncome) * 100;
    }
    
    function calculateNetProfitMargin(operatingIncome, costOfGoodsSold) {
      return ((operatingIncome - costOfGoodsSold) / operatingIncome) * 100;
    }
    
    function calculateTotalAssetTurnover(operatingIncome, totalAssets) {
      return operatingIncome / totalAssets;
    }
    
    function calculateROA(netIncome, totalAssets) {
      return (netIncome / totalAssets) * 100;
    }
    
    function calculateEquityMultiplier(totalAssets, totalLiabilities) {
      return totalAssets / totalLiabilities;
    }
    
    function calculateROE(netIncome, totalLiabilities) {
      return (netIncome / totalLiabilities) * 100;
    }
  </script>
</body>
</html>