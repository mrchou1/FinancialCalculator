<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>财务指标计算器</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      border: 1px solid black;
      padding: 8px;
    }

    th {
      background-color: #f2f2f2;
    }

    #input-form {
      margin-top: 20px;
    }

    #result {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <table>
    <thead>
      <tr>
        <th>指标名称</th>
        <th>指标计算公式</th>
        <th>指标理想范围</th>
        <th>指标含义描述</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>流动比率</td>
        <td>流动资产 ÷ 流动负债</td>
        <td>大于1</td>
        <td>衡量企业偿付短期债务能力的指标</td>
      </tr>
      <tr>
        <td>速动比率</td>
        <td>(流动资产 - 存货) ÷ 流动负债</td>
        <td>大于1</td>
        <td>衡量企业偿付短期债务能力，排除存货的影响</td>
      </tr>
      <tr>
        <td>资产负债率</td>
        <td>负债合计 ÷ 总资产</td>
        <td>小于1</td>
        <td>衡量企业资产通过负债的资金占比</td>
      </tr>
      <tr>
        <td>应收账款周转率</td>
        <td>营业收入 ÷ 应收账款</td>
        <td>越高越好</td>
        <td>衡量企业回收应收账款的速度</td>
      </tr>
      <tr>
        <td>应收账款周转天数</td>
        <td>360 ÷ 应收账款周转率</td>
        <td>越短越好</td>
        <td>衡量企业回收应收账款所需时间</td>
      </tr>
      <tr>
        <td>存货周转率</td>
        <td>营业成本 ÷ 存货平均余额</td>
        <td>越高越好</td>
        <td>衡量企业存货的周转速度</td>
      </tr>
      <tr>
        <td>存货周转天数</td>
        <td>360 ÷ 存货周转率</td>
        <td>越短越好</td>
        <td>衡量企业存货的周转速度</td>
      </tr>
      <tr>
        <td>应付账款周转率</td>
        <td>营业成本 ÷ 应付账款</td>
        <td>越高越好</td>
        <td>衡量企业支付应付账款的速度</td>
      </tr>
      <tr>
        <td>应付账款周转天数</td>
        <td>360 ÷ 应付账款周转率</td>
        <td>越短越好</td>
        <td>衡量企业支付应付账款所需时间</td>
      </tr>
      <tr>
        <td>营业周期</td>
        <td>存货周转天数 + 应收账款周转天数</td>
        <td>越短越好</td>
        <td>衡量企业从销售开始到现金收回的时间</td>
      </tr>
      <tr>
        <td>现金周期</td>
        <td>存货周转天数 + 应收账款周转天数 - 应付账款周转天数</td>
        <td>越短越好</td>
        <td>衡量企业从购买原材料到支付供应商的时间</td>
      </tr>
      <tr>
        <td>毛利率</td>
        <td>销售毛利 ÷ 营业收入</td>
        <td>越高越好</td>
        <td>衡量企业每一笔销售收入中的利润比例</td>
      </tr>
      <tr>
        <td>销售净利率</td>
        <td>净利润 ÷ 营业收入</td>
        <td>越高越好</td>
        <td>衡量企业销售收入中的净利润比例</td>
      </tr>
      <tr>
        <td>总资产周转率</td>
        <td>营业收入 ÷ 总资产</td>
        <td>越高越好</td>
        <td>衡量企业每一单位资产创造的销售收入</td>
      </tr>
      <tr>
        <td>投资回报率（ROA）</td>
        <td>销售净利率 × 总资产周转率</td>
        <td>越高越好</td>
        <td>衡量企业利用资产创造的净利润比例</td>
      </tr>
      <tr>
        <td>权益乘数</td>
        <td>资产总额 ÷ 权益总额</td>
        <td>越低越好</td>
        <td>衡量企业通过借款资金相对于股东权益的比例</td>
      </tr>
      <tr>
        <td>权益报酬率（ROE）</td>
        <td>净利润 ÷ 股东权益平均余额</td>
        <td>越高越好</td>
        <td>衡量企业利用股东权益创造的净利润比例</td>
      </tr>
    </tbody>
  </table>

  <div id="input-form">
    <h3>输入财报数据</h3>
    <label for="current-assets">流动资产：</label>
    <input type="number" id="current-assets"><br>
    <label for="current-liabilities">流动负债：</label>
    <input type="number" id="current-liabilities"><br>
    <label for="total-assets">总资产：</label>
    <input type="number" id="total-assets"><br>
    <label for="total-liabilities">负债合计：</label>
    <input type="number" id="total-liabilities"><br>
    <label for="receivables">应收账款：</label>
    <input type="number" id="receivables"><br>
    <label for="sales-revenue">营业收入：</label>
    <input type="number" id="sales-revenue"><br>
    <label for="cost-of-goods-sold">营业成本：</label>
    <input type="number" id="cost-of-goods-sold"><br>
    <label for="inventory">存货平均余额：</label>
    <input type="number" id="inventory"><br>
    <label for="payables">应付账款：</label>
    <input type="number" id="payables"><br>
    <label for="shareholders-equity">股东权益平均余额：</label>
    <input type="number" id="shareholders-equity"><br>
    <label for="net-profit">净利润：</label>
    <input type="number" id="net-profit"><br>
    <button onclick="calculate()">计算</button>
  </div>

  <div id="result">
    <h3>计算结果</h3>
    <table>
      <thead>
        <tr>
          <th>指标名称</th>
          <th>计算结果</th>
          <th>指标理想范围</th>
          <th>分析和建议</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>流动比率</td>
          <td id="liquidity-ratio"></td>
          <td>大于1</td>
          <td id="liquidity-ratio-analysis"></td>
        </tr>
        <tr>
          <td>速动比率</td>
          <td id="quick-ratio"></td>
          <td>大于1</td>
          <td id="quick-ratio-analysis"></td>
        </tr>
        <tr>
          <td>资产负债率</td>
          <td id="debt-ratio"></td>
          <td>小于1</td>
          <td id="debt-ratio-analysis"></td>
        </tr>
        <tr>
          <td>应收账款周转率</td>
          <td id="receivables-turnover"></td>
          <td>越高越好</td>
          <td id="receivables-turnover-analysis"></td>
        </tr>
        <tr>
          <td>应收账款周转天数</td>
          <td id="receivables-turnover-days"></td>
          <td>越短越好</td>
          <td id="receivables-turnover-days-analysis"></td>
        </tr>
        <tr>
          <td>存货周转率</td>
          <td id="inventory-turnover"></td>
          <td>越高越好</td>
          <td id="inventory-turnover-analysis"></td>
        </tr>
        <tr>
          <td>存货周转天数</td>
          <td id="inventory-turnover-days"></td>
          <td>越短越好</td>
          <td id="inventory-turnover-days-analysis"></td>
        </tr>
        <tr>
          <td>应付账款周转率</td>
          <td id="payables-turnover"></td>
          <td>越高越好</td>
          <td id="payables-turnover-analysis"></td>
        </tr>
        <tr>
          <td>应付账款周转天数</td>
          <td id="payables-turnover-days"></td>
          <td>越短越好</td>
          <td id="payables-turnover-days-analysis"></td>
        </tr>
        <tr>
          <td>营业周期</td>
          <td id="operating-cycle"></td>
          <td>越短越好</td>
          <td id="operating-cycle-analysis"></td>
        </tr>
        <tr>
          <td>现金周期</td>
          <td id="cash-cycle"></td>
          <td>越短越好</td>
          <td id="cash-cycle-analysis"></td>
        </tr>
        <tr>
          <td>毛利率</td>
          <td id="gross-profit-margin"></td>
          <td>越高越好</td>
          <td id="gross-profit-margin-analysis"></td>
        </tr>
        <tr>
          <td>销售净利率</td>
          <td id="net-profit-margin"></td>
          <td>越高越好</td>
          <td id="net-profit-margin-analysis"></td>
        </tr>
        <tr>
          <td>总资产周转率</td>
          <td id="total-assets-turnover"></td>
          <td>越高越好</td>
          <td id="total-assets-turnover-analysis"></td>
        </tr>
        <tr>
          <td>投资回报率（ROA）</td>
          <td id="roa"></td>
          <td>越高越好</td>
          <td id="roa-analysis"></td>
        </tr>
        <tr>
          <td>权益乘数</td>
          <td id="equity-multiplier"></td>
          <td>越低越好</td>
          <td id="equity-multiplier-analysis"></td>
        </tr>
        <tr>
          <td>权益报酬率（ROE）</td>
          <td id="roe"></td>
          <td>越高越好</td>
          <td id="roe-analysis"></td>
        </tr>
      </tbody>
    </table>
  </div>

  <script>
    function calculate() {
      // 获取用户输入的值
      var currentAssets = parseFloat(document.getElementById('current-assets').value);
      var currentLiabilities = parseFloat(document.getElementById('current-liabilities').value);
      var totalAssets = parseFloat(document.getElementById('total-assets').value);
      var totalLiabilities = parseFloat(document.getElementById('total-liabilities').value);
      var receivables = parseFloat(document.getElementById('receivables').value);
      var salesRevenue = parseFloat(document.getElementById('sales-revenue').value);
      var costOfGoodsSold = parseFloat(document.getElementById('cost-of-goods-sold').value);
      var inventory = parseFloat(document.getElementById('inventory').value);
      var payables = parseFloat(document.getElementById('payables').value);
      var shareholdersEquity = parseFloat(document.getElementById('shareholders-equity').value);
      var netprofit = parseFloat(document.getElementById('net-profit').value); //增加净利润输入

      

      // 进行计算
      var liquidityRatio = currentAssets / currentLiabilities;
      var quickRatio = (currentAssets - inventory) / currentLiabilities;
      var debtRatio = totalLiabilities / totalAssets;
      var receivablesTurnover = salesRevenue / receivables;
      var receivablesTurnoverDays = 360 / receivablesTurnover;
      var inventoryTurnover = costOfGoodsSold / inventory;
      var inventoryTurnoverDays = 360 / inventoryTurnover;
      var payablesTurnover = costOfGoodsSold / payables;
      var payablesTurnoverDays = 360 / payablesTurnover;
      var operatingCycle = inventoryTurnoverDays + receivablesTurnoverDays;
      var cashCycle = inventoryTurnoverDays + receivablesTurnoverDays - payablesTurnoverDays;
      var grossProfitMargin = (salesRevenue - costOfGoodsSold) / salesRevenue;
      var netProfitMargin = netprofit / salesRevenue;
      var totalAssetsTurnover = salesRevenue / totalAssets;
      var roa = netProfitMargin * totalAssetsTurnover;
      var equityMultiplier = totalAssets / shareholdersEquity;
      var roe = netprofit / shareholdersEquity;

      // 显示计算结果
      document.getElementById('liquidity-ratio').textContent = liquidityRatio.toFixed(2);
      document.getElementById('quick-ratio').textContent = quickRatio.toFixed(2);
      document.getElementById('debt-ratio').textContent = debtRatio.toFixed(2);
      document.getElementById('receivables-turnover').textContent = receivablesTurnover.toFixed(2);
      document.getElementById('receivables-turnover-days').textContent = receivablesTurnoverDays.toFixed(2);
      document.getElementById('inventory-turnover').textContent = inventoryTurnover.toFixed(2);
      document.getElementById('inventory-turnover-days').textContent = inventoryTurnoverDays.toFixed(2);
      document.getElementById('payables-turnover').textContent = payablesTurnover.toFixed(2);
      document.getElementById('payables-turnover-days').textContent = payablesTurnoverDays.toFixed(2);
      document.getElementById('operating-cycle').textContent = operatingCycle.toFixed(2);
      document.getElementById('cash-cycle').textContent = cashCycle.toFixed(2);
      document.getElementById('gross-profit-margin').textContent = (grossProfitMargin * 100).toFixed(2) + "%";
      document.getElementById('net-profit-margin').textContent = (netProfitMargin * 100).toFixed(2) + "%";
      document.getElementById('total-assets-turnover').textContent = totalAssetsTurnover.toFixed(2);
      document.getElementById('roa').textContent = (roa * 100).toFixed(2) + "%";
      document.getElementById('equity-multiplier').textContent = equityMultiplier.toFixed(2);
      document.getElementById('roe').textContent = (roe * 100).toFixed(2) + "%";

      // 分析结果并给出建议
      document.getElementById('liquidity-ratio-analysis').innerHTML = analyzeRatio(liquidityRatio, 1, "流动比率");
      document.getElementById('quick-ratio-analysis').innerHTML = analyzeRatio(quickRatio, 1, "速动比率");
      document.getElementById('debt-ratio-analysis').innerHTML = analyzeRatio(debtRatio, 0, "资产负债率");
      document.getElementById('receivables-turnover-days-analysis').innerHTML = analyzeDays(receivablesTurnoverDays, "应收账款周转天数");
      document.getElementById('inventory-turnover-analysis').innerHTML = analyzeRatio(inventoryTurnover, Infinity, "存货周转率");
      document.getElementById('inventory-turnover-days-analysis').innerHTML = analyzeDays(inventoryTurnoverDays, "存货周转天数");
      document.getElementById('payables-turnover-analysis').innerHTML = analyzeRatio(payablesTurnover, Infinity, "应付账款周转率");
      document.getElementById('payables-turnover-days-analysis').innerHTML = analyzeDays(payablesTurnoverDays, "应付账款周转天数");
      document.getElementById('operating-cycle-analysis').innerHTML = analyzeDays(operatingCycle, "营业周期");
      document.getElementById('cash-cycle-analysis').innerHTML = analyzeDays(cashCycle, "现金周期");
      document.getElementById('gross-profit-margin-analysis').innerHTML = analyzePercentage(grossProfitMargin * 100, "毛利率");
      document.getElementById('net-profit-margin-analysis').innerHTML = analyzePercentage(netProfitMargin * 100, "销售净利率");
      document.getElementById('total-assets-turnover-analysis').innerHTML = analyzeRatio(totalAssetsTurnover, Infinity, "总资产周转率");
      document.getElementById('roa-analysis').innerHTML = analyzePercentage(roa * 100, "投资回报率（ROA）");
      document.getElementById('equity-multiplier-analysis').innerHTML = analyzeRatio(equityMultiplier, 0, "权益乘数");
      document.getElementById('roe-analysis').innerHTML = analyzePercentage(roe * 100, "权益报酬率（ROE）");
    }

    function analyzeRatio(value, ideal, indicatorName) {
      if (value > ideal) {
        return indicatorName + "高于理想值，表示企业具备较强的特征。";
      } else if (value < ideal) {
        return indicatorName + "低于理想值，表示企业需要改进。";
      } else {
        return indicatorName + "达到理想值。";
      }
    }

    function analyzeDays(value, indicatorName) {
      if (value < 365) {
        return indicatorName + "较短，企业能够更快地回收资金。";
      } else if (value > 365) {
        return indicatorName + "较长，企业需要加快资金周转。";
      } else {
        return indicatorName + "符合行业平均水平。";
      }
    }

    function analyzePercentage(value, indicatorName) {
      if (value > 0) {
        return indicatorName + "为正数，表示企业实现了利润。";
      } else if (value < 0) {
        return indicatorName + "为负数，表示企业亏损。";
      } else {
        return indicatorName + "为零，表示企业没有利润。";
      }
    }
  </script>
</body>
</html>